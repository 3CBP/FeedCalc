<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dairy TMR Calculator</title>
  <link rel="manifest" href="manifest.json">
  <link rel="apple-touch-icon" href="logo.jpeg">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="theme-color" content="#1565c0">
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <style>
    body{background:#1565c0;color:#fff;font-family:-apple-system,sans-serif;margin:0;padding:0;position:relative;min-height:100vh;padding-bottom:180px;box-sizing:border-box;}
    header{text-align:center;padding:40px 20px;background:#0d47a1;}
    .logo{max-width:90px;max-height:90px;border-radius:50%;border:4px solid #fff;margin:0 auto;display:block;}
    h1{margin:15px 0;font-size:28px;}
    .tabs{display:flex;gap:10px;margin:20px;}
    .tab{flex:1;padding:15px;background:rgba(255,255,255,.2);text-align:center;border-radius:8px;cursor:pointer;font-weight:bold;}
    .tab.active{background:#fff;color:#0d47a1;}
    .content{display:none;padding:10px 20px;}
    .content.active{display:block;}
    input,select,button{width:100%;padding:12px;margin:8px 0;border:none;border-radius:8px;font-size:16px;}
    button{background:#ff9800;color:#000;font-weight:bold;cursor:pointer;}
    .add{background:#4caf50;}
    .del{background:#d32f2f;width:auto;padding:8px 16px;font-size:14px;}
    .row{display:flex;gap:10px;align-items:center;margin:10px 0;background:rgba(255,255,255,.1);padding:12px;border-radius:8px;}
    .row input[type=number]{width:110px;text-align:center;}
    .result{margin-top:30px;}
    .feedsheet{background:#fff;color:#000;padding:20px;margin:0;}
    .loadline{display:flex;justify-content:space-between;font-size:32px;font-weight:900;padding:10px 0;border-bottom:2px dashed #000;}
    .cumulative{font-size:28px;color:#000;text-align:right;margin:8px 0;font-weight:bold;}
    .big{font-size:60px;color:#000;font-weight:900;}
    .ready{background:#fff;color:#000;padding:15px;font-size:36px;text-align:center;font-weight:bold;border-bottom:4px solid #000;}
    #login,#loading{position:fixed;top:0;left:0;width:100%;height:100%;background:#0d47a1;display:flex;flex-direction:column;align-items:center;justify-content:center;z-index:9999;}
    #login input{width:80%;max-width:340px;padding:16px;margin:12px;font-size:22px;border-radius:12px;text-align:center;}
    #login button{padding:18px 50px;font-size:22px;background:#ff9800;border:none;border-radius:12px;}
    #error{color:#ff5252;margin-top:15px;display:none;}
    .backupPanel{margin:30px 20px;padding:20px;background:rgba(13,71,161,0.95);border-radius:15px;text-align:center;display:none;}
    .backupPanel button{margin:10px 0;padding:16px;font-size:18px;}
    .logoutBottom{background:#d32f2f !important;}
    @media print {
      @page { size: letter portrait; margin: 0.5in; }
      body * { visibility: hidden; }
      .feedsheet, .feedsheet * { visibility: visible; }
      .feedsheet { position: absolute; left: 0; top: 0; width: 100%; padding: 0; margin: 0; border: none; box-shadow: none; }
      .ready { font-size: 40px; padding: 20px 0; border-bottom: 6px double #000; }
      h2 { font-size: 36px; margin: 20px 0; text-align: center; }
      .loadline { font-size: 34px; padding: 12px 0; border-bottom: 3px dashed #000; }
      .cumulative { font-size: 30px; margin: 10px 0; }
      .big { font-size: 80px; margin: 30px 0; }
    }
  </style>
</head>
<body>

<!-- (your login, backup panel, header, tabs, calc, groups – all the same as your current file) -->

<div id="calc" class="content active">
  <!-- (your calculator UI – unchanged) -->
  <button onclick="calculate()">GENERATE BATCH SHEET</button>
  <button onclick="window.print()">PRINT SHEET</button>
  <div id="result" class="result"></div>
</div>

<!-- (rest of your code – unchanged) -->

<script>
  // (your full Supabase and app logic – unchanged from the last working version)
</script>
</body>
</html>